"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[930],{8132:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"notebooks/photosynthesis-analysis","title":"Community Notebook: Photosynthesis Analysis with PhyTorch","description":"This notebook demonstrates fitting FvCB photosynthesis models to A-Ci response curves and extracting biological insights.","source":"@site/docs/notebooks/photosynthesis-analysis.md","sourceDirName":"notebooks","slug":"/notebooks/photosynthesis-analysis","permalink":"/docs/notebooks/photosynthesis-analysis","draft":false,"unlisted":false,"editUrl":"https://github.com/PlantSimulationLab/phytorch/tree/main/website/docs/notebooks/photosynthesis-analysis.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"LI-600 Porometer Correction","permalink":"/docs/utilities/li600-correction"},"next":{"title":"Community Notebook: Stomatal Conductance Analysis with PhyTorch","permalink":"/docs/notebooks/stomatal-conductance-analysis"}}');var i=t(4848),a=t(8453);const o={sidebar_position:1},r="Community Notebook: Photosynthesis Analysis with PhyTorch",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Load and Prepare Data",id:"load-and-prepare-data",level:2},{value:"Fit FvCB Models",id:"fit-fvcb-models",level:2},{value:"Visualize A-Ci Curves",id:"visualize-a-ci-curves",level:2},{value:"Compare Photosynthetic Capacity",id:"compare-photosynthetic-capacity",level:2},{value:"Key Insights",id:"key-insights",level:2},{value:"Biological Interpretation",id:"biological-interpretation",level:3},{value:"Statistical Analysis",id:"statistical-analysis",level:3},{value:"Limitations Considered",id:"limitations-considered",level:2},{value:"Recommendations",id:"recommendations",level:2},{value:"References",id:"references",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"community-notebook-photosynthesis-analysis-with-phytorch",children:"Community Notebook: Photosynthesis Analysis with PhyTorch"})}),"\n",(0,i.jsx)(n.p,{children:"This notebook demonstrates fitting FvCB photosynthesis models to A-Ci response curves and extracting biological insights."}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),": Fit the FvCB model to A-Ci curves from different genotypes to compare photosynthetic capacity"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Dataset"}),": LI-COR 6800 measurements of A-Ci curves at 25\xb0C and saturating light (1500 \u03bcmol/m\xb2/s PPFD)"]}),"\n",(0,i.jsx)(n.h2,{id:"load-and-prepare-data",children:"Load and Prepare Data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from phytorch import fit\nfrom phytorch.models.photosynthesis import FvCB\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Load A-Ci curve data for multiple genotypes\ngenotypes = ['Genotype_A', 'Genotype_B', 'Genotype_C']\nresults = {}\n\nfor geno in genotypes:\n    df = pd.read_csv(f'data/{geno}_aci.csv')\n\n    # Prepare data dictionary\n    data = {\n        'Tleaf': df['Tleaf'].values,\n        'Ci': df['Ci'].values,\n        'PPFD': df['PPFD'].values,\n        'Photo': df['Photo'].values\n    }\n\n    results[geno] = {'data': data}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"fit-fvcb-models",children:"Fit FvCB Models"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Fit models for each genotype\nfor geno in genotypes:\n    data = results[geno]['data']\n\n    # Initialize FvCB model\n    model = FvCB()\n\n    # Fit model with PyTorch optimizer\n    options = {'learn_rate': 0.08, 'max_iterations': 20000, 'verbose': True}\n    result = fit(model, data, options)\n\n    # Store results\n    results[geno]['model'] = model\n    results[geno]['result'] = result\n\n    # Print fitted parameters\n    print(f\"\\n{geno} Fitted Parameters:\")\n    print(f\"  Vcmax25: {result.parameters['Vcmax25']:.2f} \u03bcmol/m\xb2/s\")\n    print(f\"  Jmax25: {result.parameters['Jmax25']:.2f} \u03bcmol/m\xb2/s\")\n    print(f\"  Rd25: {result.parameters['Rd25']:.2f} \u03bcmol/m\xb2/s\")\n    print(f\"  TPU25: {result.parameters['TPU25']:.2f} \u03bcmol/m\xb2/s\")\n    print(f\"  Jmax/Vcmax: {result.parameters['Jmax25']/result.parameters['Vcmax25']:.2f}\")\n"})}),"\n",(0,i.jsx)(n.h2,{id:"visualize-a-ci-curves",children:"Visualize A-Ci Curves"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"fig, axes = plt.subplots(1, 3, figsize=(15, 5))\n\nfor idx, geno in enumerate(genotypes):\n    data = results[geno]['data']\n    result = results[geno]['result']\n\n    ax = axes[idx]\n    ax.scatter(data['Ci'], data['Photo'], alpha=0.6, s=80, label='Observed')\n    ax.plot(data['Ci'], result.predictions, 'r-', linewidth=2, label='Fitted FvCB')\n    ax.set_xlabel('Ci (\u03bcmol/mol)', fontsize=12)\n    ax.set_ylabel('A (\u03bcmol/m\xb2/s)', fontsize=12)\n    ax.set_title(geno, fontsize=14, fontweight='bold')\n    ax.legend()\n    ax.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.savefig('aci_curves_comparison.png', dpi=300, bbox_inches='tight')\nplt.show()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"compare-photosynthetic-capacity",children:"Compare Photosynthetic Capacity"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Extract key parameters for comparison\nparams_df = pd.DataFrame({\n    'Genotype': genotypes,\n    'Vcmax25': [results[g]['result'].parameters['Vcmax25'] for g in genotypes],\n    'Jmax25': [results[g]['result'].parameters['Jmax25'] for g in genotypes],\n    'Rd25': [results[g]['result'].parameters['Rd25'] for g in genotypes],\n    'TPU25': [results[g]['result'].parameters['TPU25'] for g in genotypes]\n})\n\n# Calculate Jmax/Vcmax ratio\nparams_df['Jmax_Vcmax'] = params_df['Jmax25'] / params_df['Vcmax25']\n\n# Plot parameter comparison\nfig, axes = plt.subplots(2, 2, figsize=(12, 10))\n\nparams = ['Vcmax25', 'Jmax25', 'Rd25', 'Jmax_Vcmax']\ntitles = ['Maximum Carboxylation Rate', 'Maximum Electron Transport',\n          'Day Respiration', 'Jmax/Vcmax Ratio']\nylabels = ['Vcmax25 (\u03bcmol/m\xb2/s)', 'Jmax25 (\u03bcmol/m\xb2/s)',\n           'Rd25 (\u03bcmol/m\xb2/s)', 'Jmax/Vcmax']\n\nfor idx, (param, title, ylabel) in enumerate(zip(params, titles, ylabels)):\n    ax = axes[idx // 2, idx % 2]\n    ax.bar(params_df['Genotype'], params_df[param], color='steelblue', alpha=0.7)\n    ax.set_ylabel(ylabel, fontsize=11)\n    ax.set_title(title, fontsize=12, fontweight='bold')\n    ax.grid(True, alpha=0.3, axis='y')\n\nplt.tight_layout()\nplt.savefig('parameter_comparison.png', dpi=300, bbox_inches='tight')\nplt.show()\n\nprint(\"\\nParameter Summary:\")\nprint(params_df.to_string(index=False))\n"})}),"\n",(0,i.jsx)(n.h2,{id:"key-insights",children:"Key Insights"}),"\n",(0,i.jsx)(n.h3,{id:"biological-interpretation",children:"Biological Interpretation"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Vcmax vs Jmax"}),": The ratio of Jmax/Vcmax typically ranges from 1.5-2.5 in C3 plants"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Values < 1.5 suggest Rubisco limitation"}),"\n",(0,i.jsx)(n.li,{children:"Values > 2.5 suggest RuBP regeneration capacity exceeds carboxylation capacity"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Vcmax Variation"}),": Differences in Vcmax among genotypes indicate:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Variations in Rubisco content and/or activity"}),"\n",(0,i.jsx)(n.li,{children:"Potential for selecting high-capacity genotypes"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Rd (Dark Respiration)"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Typically 1-2% of Vcmax25"}),"\n",(0,i.jsx)(n.li,{children:"Higher Rd can reduce net carbon gain"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"statistical-analysis",children:"Statistical Analysis"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from scipy import stats\n\n# Perform ANOVA to test for significant differences\nvcmax_values = [results[g]['result'].parameters['Vcmax25'] for g in genotypes]\njmax_values = [results[g]['result'].parameters['Jmax25'] for g in genotypes]\n\n# One-way ANOVA\nf_stat_vcmax, p_value_vcmax = stats.f_oneway(*[\n    [results[g]['result'].parameters['Vcmax25']] for g in genotypes\n])\n\nprint(f\"\\nVcmax ANOVA: F = {f_stat_vcmax:.3f}, p = {p_value_vcmax:.4f}\")\n\nif p_value_vcmax < 0.05:\n    print(\"  \u2713 Significant differences detected among genotypes\")\nelse:\n    print(\"  \xd7 No significant differences among genotypes\")\n"})}),"\n",(0,i.jsx)(n.h2,{id:"limitations-considered",children:"Limitations Considered"}),"\n",(0,i.jsx)(n.p,{children:"The FvCB model assumes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Steady-state photosynthesis"}),"\n",(0,i.jsx)(n.li,{children:"Uniform light distribution in the leaf"}),"\n",(0,i.jsx)(n.li,{children:"Well-mixed chloroplast"}),"\n",(0,i.jsx)(n.li,{children:"No stomatal limitation (using Ci, not Ca)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"recommendations",children:"Recommendations"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Collect A-Ci curves across multiple temperatures to estimate temperature response parameters"}),"\n",(0,i.jsx)(n.li,{children:"Measure A-Q curves (light response) to validate Jmax estimates"}),"\n",(0,i.jsx)(n.li,{children:"Conduct measurements on multiple leaves per genotype for statistical power"}),"\n",(0,i.jsx)(n.li,{children:"Consider leaf nitrogen content to explain Vcmax variation"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Farquhar, G. D., von Caemmerer, S., & Berry, J. A. (1980). A biochemical model of photosynthetic CO2 assimilation. ",(0,i.jsx)(n.em,{children:"Planta"}),", 149(1), 78-90."]}),"\n",(0,i.jsxs)(n.li,{children:["Sharkey, T. D., et al. (2007). Fitting photosynthetic carbon dioxide response curves. ",(0,i.jsx)(n.em,{children:"Plant, Cell & Environment"}),", 30(9), 1035-1040."]}),"\n",(0,i.jsx)(n.li,{children:"Lei, T., Rizzo, K. T., & Bailey, B. N. (2025). PhoTorch: a robust and generalized biochemical photosynthesis model fitting package."}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var s=t(6540);const i={},a=s.createContext(i);function o(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);